<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>åœ‹åº¦å•†åº— â€” ç’°éŠä¸–ç•Œæ–‡åŒ–å¤§æŒ‘æˆ°</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&family=Fredoka:wght@400;600;700&family=Bangers&display=swap" rel="stylesheet">
<style>
:root {
  --navy: #0a1628;
  --gold: #f5c842;
  --gold-dark: #d4a017;
  --asia: #e74c3c;
  --europe: #3498db;
  --africa: #e67e22;
  --americas: #2ecc71;
  --oceania: #9b59b6;
  --correct: #27ae60;
  --wrong: #c0392b;
  --bg-dark: #0d1b2a;
  --bg-card: #1b2838;
  --text-light: #ecf0f1;
  --text-muted: #95a5a6;
  --radius: 16px;
  --shadow: 0 8px 32px rgba(0,0,0,0.4);
}
* { margin:0; padding:0; box-sizing:border-box; }
html, body { 
  width:100%; height:100%; overflow:hidden;
  font-family:'Noto Sans TC','Fredoka',sans-serif;
  background: var(--bg-dark);
  color: var(--text-light);
}
.screen { 
  display:none; width:100%; height:100%; 
  position:absolute; top:0; left:0;
  overflow-y:auto; overflow-x:hidden;
}
.screen.active { display:flex; flex-direction:column; }

/* ===== ANIMATIONS ===== */
@keyframes fadeIn { from{opacity:0;transform:translateY(20px)} to{opacity:1;transform:translateY(0)} }
@keyframes slideUp { from{opacity:0;transform:translateY(60px)} to{opacity:1;transform:translateY(0)} }
@keyframes pulse { 0%,100%{transform:scale(1)} 50%{transform:scale(1.05)} }
@keyframes shake { 0%,100%{transform:translateX(0)} 20%{transform:translateX(-8px)} 40%{transform:translateX(8px)} 60%{transform:translateX(-4px)} 80%{transform:translateX(4px)} }
@keyframes bounceIn { 0%{transform:scale(0);opacity:0} 50%{transform:scale(1.2)} 100%{transform:scale(1);opacity:1} }
@keyframes glow { 0%,100%{box-shadow:0 0 20px rgba(245,200,66,0.3)} 50%{box-shadow:0 0 40px rgba(245,200,66,0.6)} }
@keyframes confetti-fall { 0%{transform:translateY(-100vh) rotate(0deg);opacity:1} 100%{transform:translateY(100vh) rotate(720deg);opacity:0} }
@keyframes fillBar { from{width:0%} }
@keyframes float { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-10px)} }
@keyframes stampIn { 0%{transform:scale(3) rotate(-30deg);opacity:0} 60%{transform:scale(0.9) rotate(5deg);opacity:1} 100%{transform:scale(1) rotate(0deg);opacity:1} }
@keyframes timerPulse { 0%,100%{color:#fff} 50%{color:#e74c3c;transform:scale(1.1)} }
@keyframes correctFlash { 0%{background:var(--correct)} 100%{background:transparent} }
@keyframes countDown { 0%{transform:scale(2);opacity:0} 50%{transform:scale(1);opacity:1} 100%{transform:scale(0.8);opacity:0} }

/* ===== HOME SCREEN ===== */
#home {
  background: linear-gradient(135deg, #0a1628 0%, #1a2a4a 50%, #0d1b2a 100%);
  align-items:center; justify-content:center; text-align:center;
  position:relative;
}
#home::before {
  content:''; position:absolute; inset:0;
  background: radial-gradient(circle at 30% 40%, rgba(245,200,66,0.08) 0%, transparent 50%),
              radial-gradient(circle at 70% 60%, rgba(155,89,182,0.06) 0%, transparent 50%);
}
.home-content { position:relative; z-index:1; padding:20px; }
.game-logo {
  font-family:'Bangers',cursive; font-size:clamp(3rem,8vw,6rem);
  color:var(--gold); text-shadow: 3px 3px 0 var(--gold-dark), 6px 6px 0 rgba(0,0,0,0.3);
  line-height:1.1; margin-bottom:8px;
  animation: float 3s ease-in-out infinite;
}
.game-subtitle {
  font-size:clamp(1rem,2.5vw,1.5rem); color:var(--text-muted);
  margin-bottom:40px; letter-spacing:2px;
}
.role-buttons { display:flex; gap:20px; flex-wrap:wrap; justify-content:center; }
.role-btn {
  padding:20px 40px; border-radius:var(--radius); border:3px solid var(--gold);
  background: rgba(245,200,66,0.1); color:var(--gold);
  font-size:1.3rem; font-weight:700; cursor:pointer;
  font-family:'Noto Sans TC',sans-serif;
  transition:all 0.3s; position:relative; overflow:hidden;
}
.role-btn:hover { background:var(--gold); color:var(--navy); transform:translateY(-3px); box-shadow:var(--shadow); }
.role-btn .role-icon { font-size:2rem; display:block; margin-bottom:8px; }
.role-btn .role-desc { font-size:0.85rem; color:var(--text-muted); font-weight:400; }
.role-btn:hover .role-desc { color:var(--navy); }

/* ===== ROOM SETUP ===== */
#room-setup {
  background: linear-gradient(135deg, #0a1628, #1a2a4a);
  align-items:center; justify-content:center; text-align:center; padding:20px;
}
.setup-card {
  background:var(--bg-card); border-radius:var(--radius); padding:40px;
  box-shadow:var(--shadow); max-width:500px; width:100%;
  animation: fadeIn 0.5s ease;
}
.setup-card h2 { font-family:'Bangers',cursive; font-size:2rem; color:var(--gold); margin-bottom:20px; }
.setup-input {
  width:100%; padding:16px; border-radius:12px; border:2px solid rgba(255,255,255,0.1);
  background:rgba(255,255,255,0.05); color:#fff; font-size:1.2rem; text-align:center;
  font-family:'Fredoka',sans-serif; letter-spacing:4px; margin-bottom:16px;
  transition:border-color 0.3s;
}
.setup-input:focus { outline:none; border-color:var(--gold); }
.setup-input::placeholder { color:var(--text-muted); letter-spacing:1px; font-size:1rem; }
.btn-primary {
  padding:14px 32px; border-radius:12px; border:none;
  background:var(--gold); color:var(--navy); font-size:1.1rem;
  font-weight:700; cursor:pointer; font-family:'Noto Sans TC',sans-serif;
  transition:all 0.3s; width:100%;
}
.btn-primary:hover { background:#ffe066; transform:translateY(-2px); box-shadow:0 4px 16px rgba(245,200,66,0.4); }
.btn-secondary {
  padding:10px 24px; border-radius:10px; border:2px solid var(--text-muted);
  background:transparent; color:var(--text-muted); font-size:0.95rem;
  cursor:pointer; font-family:'Noto Sans TC',sans-serif;
  transition:all 0.3s; margin-top:12px;
}
.btn-secondary:hover { border-color:var(--gold); color:var(--gold); }
.room-code-display {
  font-family:'Bangers',cursive; font-size:3rem; color:var(--gold);
  letter-spacing:8px; padding:16px; margin:16px 0;
  border:3px dashed var(--gold); border-radius:12px;
  animation: glow 2s ease-in-out infinite;
}

/* ===== TEAM SELECT ===== */
#team-select {
  background: linear-gradient(135deg, #0a1628, #1a2a4a);
  align-items:center; justify-content:center; padding:20px;
}
.team-grid {
  display:grid; grid-template-columns:repeat(3,1fr); gap:16px;
  max-width:600px; width:100%; margin-top:24px;
}
.team-card {
  padding:24px 16px; border-radius:var(--radius); border:3px solid rgba(255,255,255,0.15);
  background:rgba(255,255,255,0.05); text-align:center;
  cursor:pointer; transition:all 0.3s; position:relative;
}
.team-card:hover { transform:translateY(-4px); border-color:var(--gold); background:rgba(245,200,66,0.1); }
.team-card.selected { border-color:var(--gold); background:rgba(245,200,66,0.2); }
.team-card .team-emoji { font-size:2.5rem; margin-bottom:8px; display:block; }
.team-card .team-name { font-weight:700; font-size:1.2rem; }

/* ===== TEACHER DASHBOARD ===== */
#teacher-dashboard {
  background: var(--bg-dark); padding:0;
}
.dashboard-header {
  background: linear-gradient(90deg, #0d1b2a, #1a2a4a);
  padding:12px 24px; display:flex; align-items:center; justify-content:space-between;
  border-bottom:2px solid rgba(245,200,66,0.2); flex-shrink:0;
}
.dash-title { font-family:'Bangers',cursive; font-size:1.5rem; color:var(--gold); }
.dash-room-code { 
  font-family:'Fredoka',sans-serif; font-size:1rem; 
  background:rgba(245,200,66,0.15); color:var(--gold);
  padding:6px 16px; border-radius:8px; letter-spacing:3px;
}
.dashboard-body {
  display:grid; grid-template-columns:1fr 320px; gap:0;
  flex:1; overflow:hidden; min-height:0;
}
.map-section {
  padding:20px; overflow-y:auto;
  display:flex; flex-direction:column; align-items:center; justify-content:center;
}
.continent-map {
  display:grid; grid-template-columns:repeat(3,1fr); grid-template-rows:repeat(2,1fr);
  gap:16px; max-width:800px; width:100%;
}
.continent-card {
  border-radius:var(--radius); padding:24px 16px; text-align:center;
  position:relative; overflow:hidden; cursor:pointer;
  transition:all 0.3s; min-height:140px;
  display:flex; flex-direction:column; align-items:center; justify-content:center;
}
.continent-card::before {
  content:''; position:absolute; inset:0; opacity:0.15;
  background:radial-gradient(circle at 50% 50%, currentColor, transparent 70%);
}
.continent-card:hover { transform:translateY(-4px); }
.continent-card[data-continent="asia"] { background:rgba(231,76,60,0.15); border:2px solid rgba(231,76,60,0.4); color:var(--asia); }
.continent-card[data-continent="europe"] { background:rgba(52,152,219,0.15); border:2px solid rgba(52,152,219,0.4); color:var(--europe); }
.continent-card[data-continent="africa"] { background:rgba(230,126,34,0.15); border:2px solid rgba(230,126,34,0.4); color:var(--africa); }
.continent-card[data-continent="americas"] { background:rgba(46,204,113,0.15); border:2px solid rgba(46,204,113,0.4); color:var(--americas); }
.continent-card[data-continent="oceania"] { background:rgba(155,89,182,0.15); border:2px solid rgba(155,89,182,0.4); color:var(--oceania); grid-column:2; }
.continent-emoji { font-size:2.5rem; margin-bottom:8px; }
.continent-name { font-weight:700; font-size:1.1rem; color:var(--text-light); }
.continent-countries { font-size:0.8rem; color:var(--text-muted); margin-top:4px; }

/* Sidebar leaderboard */
.sidebar {
  background:#111d2e; border-left:2px solid rgba(245,200,66,0.15);
  padding:20px; overflow-y:auto;
}
.sidebar-title {
  font-family:'Bangers',cursive; font-size:1.4rem; color:var(--gold);
  text-align:center; margin-bottom:20px; letter-spacing:2px;
}
.team-row {
  background:rgba(255,255,255,0.04); border-radius:12px;
  padding:12px; margin-bottom:12px; transition:all 0.3s;
}
.team-row-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:8px; }
.team-row-name { font-weight:700; font-size:1rem; }
.team-row-score { font-family:'Fredoka',sans-serif; font-size:0.9rem; color:var(--gold); }
.hp-bar-bg {
  height:24px; background:rgba(255,255,255,0.08); border-radius:12px;
  overflow:hidden; position:relative;
}
.hp-bar-fill {
  height:100%; border-radius:12px; transition:width 0.8s cubic-bezier(0.4,0,0.2,1);
  position:relative; min-width:0;
}
.hp-bar-fill::after {
  content:''; position:absolute; inset:0;
  background:linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
  animation: shimmer 2s infinite;
}
@keyframes shimmer { 0%{transform:translateX(-100%)} 100%{transform:translateX(100%)} }
.hp-bar-text {
  position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
  font-size:0.75rem; font-weight:700; text-shadow:0 1px 2px rgba(0,0,0,0.5); z-index:1;
}
.team-stamps { display:flex; gap:4px; margin-top:8px; }
.stamp {
  width:28px; height:28px; border-radius:50%; display:flex; align-items:center; justify-content:center;
  font-size:0.7rem; border:2px solid rgba(255,255,255,0.1); opacity:0.3;
  transition:all 0.3s;
}
.stamp.completed { opacity:1; animation:stampIn 0.5s ease; border-color:transparent; }
.stamp[data-c="asia"] { background:var(--asia); }
.stamp[data-c="europe"] { background:var(--europe); }
.stamp[data-c="africa"] { background:var(--africa); }
.stamp[data-c="americas"] { background:var(--americas); }
.stamp[data-c="oceania"] { background:var(--oceania); }

.team-colors { --t1:#e74c3c; --t2:#3498db; --t3:#2ecc71; --t4:#e67e22; --t5:#9b59b6; --t6:#1abc9c; }

/* ===== QR CODE MODAL ===== */
.modal-overlay {
  display:none; position:fixed; inset:0; background:rgba(0,0,0,0.8);
  z-index:1000; align-items:center; justify-content:center; padding:20px;
}
.modal-overlay.active { display:flex; }
.modal-card {
  background:var(--bg-card); border-radius:var(--radius); padding:32px;
  max-width:800px; width:100%; max-height:90vh; overflow-y:auto;
  animation:bounceIn 0.4s ease; position:relative;
}
.modal-close {
  position:absolute; top:12px; right:16px; background:none; border:none;
  color:var(--text-muted); font-size:1.5rem; cursor:pointer;
}
.modal-close:hover { color:#fff; }
.qr-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:20px; margin-top:20px; }
.qr-item { text-align:center; padding:16px; background:rgba(255,255,255,0.03); border-radius:12px; }
.qr-item canvas, .qr-item img { margin:0 auto; }
.qr-label { margin-top:8px; font-weight:700; font-size:0.9rem; }

/* ===== STUDENT MAP ===== */
#student-map {
  background:linear-gradient(135deg, #0a1628, #1a2a4a);
  align-items:center; padding:20px;
}
.student-header {
  width:100%; display:flex; align-items:center; justify-content:space-between;
  padding:12px 0; flex-shrink:0;
}
.student-team-badge {
  font-family:'Bangers',cursive; font-size:1.3rem; padding:6px 16px;
  border-radius:8px; letter-spacing:2px;
}
.student-map-grid {
  display:grid; grid-template-columns:repeat(2,1fr); gap:16px;
  max-width:500px; width:100%; flex:1; align-content:center;
}
.student-continent-btn {
  border-radius:var(--radius); padding:24px; text-align:center;
  cursor:pointer; transition:all 0.3s; border:3px solid rgba(255,255,255,0.1);
  background:rgba(255,255,255,0.05); position:relative;
}
.student-continent-btn:hover:not(.locked):not(.done) { transform:scale(1.03); }
.student-continent-btn.done { opacity:0.6; }
.student-continent-btn.done::after {
  content:'âœ…'; position:absolute; top:8px; right:8px; font-size:1.2rem;
}
.student-continent-btn.current { animation:pulse 1.5s infinite; border-color:var(--gold); }
.student-continent-btn:last-child { grid-column:1/-1; max-width:50%; justify-self:center; }
.smap-emoji { font-size:2rem; }
.smap-name { font-weight:700; margin-top:4px; }
.smap-status { font-size:0.8rem; color:var(--text-muted); margin-top:4px; }

/* ===== QUIZ SCREEN ===== */
#quiz-screen {
  background:var(--bg-dark); padding:0;
}
.quiz-header {
  padding:12px 20px; display:flex; align-items:center; justify-content:space-between;
  background:rgba(0,0,0,0.3); flex-shrink:0;
}
.quiz-continent-badge {
  padding:6px 14px; border-radius:8px; font-weight:700; font-size:0.9rem;
}
.quiz-timer {
  font-family:'Bangers',cursive; font-size:2rem; min-width:60px; text-align:center;
}
.quiz-timer.urgent { animation:timerPulse 0.5s infinite; color:var(--wrong); }
.quiz-progress {
  height:6px; background:rgba(255,255,255,0.1); flex-shrink:0;
}
.quiz-progress-fill {
  height:100%; transition:width 0.3s ease; background:var(--gold);
}
.quiz-body {
  flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center;
  padding:24px; overflow-y:auto;
}
.quiz-question-num {
  font-size:0.9rem; color:var(--text-muted); margin-bottom:8px;
}
.quiz-question-text {
  font-size:clamp(1.1rem,3vw,1.6rem); font-weight:700; text-align:center;
  max-width:700px; line-height:1.5; margin-bottom:32px;
  animation:fadeIn 0.4s ease;
}
.quiz-options {
  display:grid; grid-template-columns:1fr 1fr; gap:12px;
  max-width:700px; width:100%;
}
.quiz-option {
  padding:16px 20px; border-radius:14px; border:3px solid rgba(255,255,255,0.15);
  background:rgba(255,255,255,0.05); cursor:pointer; transition:all 0.2s;
  font-size:1.05rem; text-align:center; font-family:'Noto Sans TC',sans-serif;
  display:flex; align-items:center; gap:12px; min-height:60px;
}
.quiz-option:hover:not(.disabled) { border-color:var(--gold); background:rgba(245,200,66,0.1); transform:translateY(-2px); }
.quiz-option .opt-letter {
  width:32px; height:32px; border-radius:8px; display:flex; align-items:center; justify-content:center;
  font-weight:700; background:rgba(255,255,255,0.1); flex-shrink:0;
}
.quiz-option.correct { border-color:var(--correct); background:rgba(39,174,96,0.2); }
.quiz-option.correct .opt-letter { background:var(--correct); }
.quiz-option.wrong { border-color:var(--wrong); background:rgba(192,57,43,0.2); animation:shake 0.4s; }
.quiz-option.wrong .opt-letter { background:var(--wrong); }
.quiz-option.disabled { pointer-events:none; opacity:0.5; }
.quiz-option.disabled.correct { opacity:1; }

/* Quiz feedback */
.quiz-feedback {
  display:none; text-align:center; padding:20px; max-width:600px;
  animation:fadeIn 0.4s ease;
}
.quiz-feedback.show { display:block; }
.feedback-icon { font-size:3rem; margin-bottom:12px; }
.feedback-text { font-size:1.1rem; font-weight:700; margin-bottom:12px; }
.feedback-fact {
  font-size:0.95rem; color:var(--text-muted); line-height:1.6;
  background:rgba(255,255,255,0.04); padding:16px; border-radius:12px;
  border-left:4px solid var(--gold); text-align:left;
}
.feedback-btn {
  margin-top:20px; padding:12px 32px; border-radius:12px; border:none;
  background:var(--gold); color:var(--navy); font-weight:700; font-size:1rem;
  cursor:pointer; font-family:'Noto Sans TC',sans-serif; transition:all 0.3s;
}
.feedback-btn:hover { background:#ffe066; transform:translateY(-2px); }

/* ===== CONTINENT COMPLETE ===== */
#continent-complete {
  background:var(--bg-dark); align-items:center; justify-content:center;
  text-align:center; padding:24px; position:relative; overflow:hidden;
}
.complete-icon { font-size:5rem; animation:bounceIn 0.6s ease; }
.complete-title { font-family:'Bangers',cursive; font-size:2.5rem; color:var(--gold); margin:16px 0; }
.complete-score { font-size:1.3rem; margin-bottom:8px; }
.complete-code {
  font-family:'Fredoka',sans-serif; font-size:2rem; letter-spacing:4px;
  background:rgba(245,200,66,0.15); color:var(--gold); padding:12px 24px;
  border-radius:12px; border:2px dashed var(--gold); margin:16px 0;
}
.complete-hint { font-size:0.9rem; color:var(--text-muted); margin-bottom:24px; }

/* ===== VICTORY ===== */
#victory-screen {
  background:radial-gradient(circle at 50% 30%, #1a2a4a, var(--bg-dark));
  align-items:center; justify-content:center; text-align:center;
  padding:24px; position:relative; overflow:hidden;
}
.victory-crown { font-size:6rem; animation:float 2s ease-in-out infinite; }
.victory-title { font-family:'Bangers',cursive; font-size:clamp(2rem,6vw,4rem); color:var(--gold); margin:16px 0; text-shadow:3px 3px 0 rgba(0,0,0,0.3); }
.victory-team { font-size:1.5rem; margin-bottom:24px; }
.final-standings { max-width:500px; width:100%; }
.final-row { display:flex; align-items:center; gap:12px; padding:10px 16px; border-radius:10px; margin-bottom:8px; background:rgba(255,255,255,0.05); }
.final-rank { font-family:'Bangers',cursive; font-size:1.5rem; width:40px; text-align:center; }
.final-rank:nth-child(1) { color:var(--gold); }
.final-info { flex:1; text-align:left; }
.final-name { font-weight:700; }
.final-pts { color:var(--gold); font-size:0.9rem; }

/* Confetti */
.confetti-piece {
  position:fixed; width:10px; height:10px; top:-20px; z-index:999;
  animation:confetti-fall linear forwards;
}

/* ===== DASHBOARD CONFIRM PANEL ===== */
.confirm-panel {
  background:rgba(0,0,0,0.3); border-radius:12px; padding:16px;
  margin-top:16px;
}
.confirm-panel h3 { font-size:1rem; color:var(--gold); margin-bottom:12px; }
.confirm-row { display:flex; gap:8px; margin-bottom:8px; flex-wrap:wrap; }
.confirm-select {
  padding:8px 12px; border-radius:8px; border:1px solid rgba(255,255,255,0.2);
  background:rgba(255,255,255,0.05); color:#fff; font-family:'Noto Sans TC',sans-serif;
}
.confirm-btn {
  padding:8px 16px; border-radius:8px; border:none;
  background:var(--correct); color:#fff; font-weight:700; cursor:pointer;
  font-family:'Noto Sans TC',sans-serif; transition:all 0.2s;
}
.confirm-btn:hover { background:#2ecc71; }

/* ===== RESPONSIVE ===== */
@media (max-width:900px) {
  .dashboard-body { grid-template-columns:1fr; }
  .sidebar { border-left:none; border-top:2px solid rgba(245,200,66,0.15); max-height:300px; }
  .continent-map { grid-template-columns:repeat(2,1fr); }
}
@media (max-width:600px) {
  .quiz-options { grid-template-columns:1fr; }
  .team-grid { grid-template-columns:repeat(2,1fr); }
  .student-map-grid { grid-template-columns:1fr; }
  .qr-grid { grid-template-columns:1fr 1fr; }
}

/* Print QR codes */
@media print {
  body { background:#fff !important; color:#000 !important; }
  .screen { display:none !important; }
  #qr-print-area { display:block !important; }
  .qr-print-item { page-break-inside:avoid; text-align:center; margin:20px; }
}
#qr-print-area { display:none; }

/* Tooltip */
.tooltip {
  position:relative;
}
.tooltip::after {
  content:attr(data-tip); position:absolute; bottom:110%; left:50%; transform:translateX(-50%);
  background:var(--navy); color:#fff; padding:6px 12px; border-radius:8px;
  font-size:0.8rem; white-space:nowrap; opacity:0; pointer-events:none; transition:opacity 0.2s;
}
.tooltip:hover::after { opacity:1; }

/* Loading spinner */
.spinner { width:40px; height:40px; border:4px solid rgba(255,255,255,0.1); border-top-color:var(--gold); border-radius:50%; animation:spin 0.8s linear infinite; margin:0 auto; }
@keyframes spin { to{transform:rotate(360deg)} }
</style>
</head>
<body>

<!-- ========== SCREEN: HOME ========== -->
<div id="home" class="screen active">
  <div class="home-content">
    <div class="game-logo">åœ‹åº¦å•†åº—</div>
    <div class="game-subtitle">ğŸŒ ç’°éŠä¸–ç•Œæ–‡åŒ–å¤§æŒ‘æˆ° ğŸŒ</div>
    <div class="role-buttons">
      <button class="role-btn" onclick="goToSetup('teacher')">
        <span class="role-icon">ğŸ«</span>
        æ•™å¸«æ¨¡å¼
        <span class="role-desc">å»ºç«‹éŠæˆ²æˆ¿é–“ & æ’è¡Œæ¦œ</span>
      </button>
      <button class="role-btn" onclick="goToSetup('student')">
        <span class="role-icon">ğŸ’</span>
        å­¸ç”Ÿæ¨¡å¼
        <span class="role-desc">æƒ QR Code é—–é—œç­”é¡Œ</span>
      </button>
    </div>
  </div>
</div>

<!-- ========== SCREEN: ROOM SETUP (TEACHER) ========== -->
<div id="room-setup" class="screen">
  <div class="setup-card">
    <h2>ğŸ® å»ºç«‹éŠæˆ²æˆ¿é–“</h2>
    <p style="color:var(--text-muted);margin-bottom:20px;">å»ºç«‹ä¸€å€‹æˆ¿é–“ä»£ç¢¼ï¼Œå­¸ç”Ÿç”¨æ­¤ä»£ç¢¼åŠ å…¥éŠæˆ²</p>
    <div id="generated-code" class="room-code-display" style="display:none;"></div>
    <button class="btn-primary" id="create-room-btn" onclick="createRoom()">ğŸš€ ç”¢ç”Ÿæˆ¿é–“ä»£ç¢¼</button>
    <button class="btn-primary" id="enter-room-btn" style="display:none;" onclick="enterDashboard()">ğŸ“Š é€²å…¥æ•™å¸«æ§åˆ¶å°</button>
    <br>
    <button class="btn-secondary" onclick="showScreen('home')">â† è¿”å›</button>
  </div>
</div>

<!-- ========== SCREEN: TEAM SELECT (STUDENT) ========== -->
<div id="team-select" class="screen">
  <div style="max-width:600px;width:100%;text-align:center;">
    <h2 style="font-family:'Bangers',cursive;font-size:2rem;color:var(--gold);margin-bottom:8px;">é¸æ“‡ä½ çš„éšŠä¼</h2>
    <p style="color:var(--text-muted);margin-bottom:24px;">å’Œå¤¥ä¼´è¨è«–å¾Œé¸æ“‡ä½ å€‘çš„éšŠä¼</p>
    <div class="team-grid" id="team-grid"></div>
    <button class="btn-primary" style="margin-top:24px;max-width:300px;" onclick="confirmTeam()" id="confirm-team-btn" disabled>âœˆï¸ å‡ºç™¼é—–é—œï¼</button>
    <br>
    <button class="btn-secondary" onclick="showScreen('home')">â† è¿”å›</button>
  </div>
</div>

<!-- ========== SCREEN: TEACHER DASHBOARD ========== -->
<div id="teacher-dashboard" class="screen">
  <div class="dashboard-header">
    <div class="dash-title">ğŸŒ åœ‹åº¦å•†åº— â€” æ•™å¸«æ§åˆ¶å°</div>
    <div style="display:flex;align-items:center;gap:12px;">
      <div class="dash-room-code" id="dash-room-code"></div>
      <button style="padding:6px 14px;border-radius:8px;border:2px solid var(--gold);background:transparent;color:var(--gold);cursor:pointer;font-family:'Noto Sans TC';font-weight:700;" onclick="showQRModal()">ğŸ“± QRç¢¼</button>
      <button style="padding:6px 14px;border-radius:8px;border:2px solid var(--wrong);background:transparent;color:var(--wrong);cursor:pointer;font-family:'Noto Sans TC';font-weight:700;" onclick="resetGame()">ğŸ”„ é‡ç½®</button>
    </div>
  </div>
  <div class="dashboard-body">
    <div class="map-section">
      <div class="continent-map" id="continent-map-teacher"></div>
      <!-- Manual confirm panel -->
      <div class="confirm-panel">
        <h3>ğŸ“‹ æ‰‹å‹•ç¢ºèªé—–é—œ</h3>
        <p style="font-size:0.8rem;color:var(--text-muted);margin-bottom:12px;">å­¸ç”Ÿå®Œæˆé—œå¡å¾Œï¼Œåœ¨æ­¤ç¢ºèªè©²çµ„éé—œ</p>
        <div class="confirm-row">
          <select class="confirm-select" id="confirm-team-select"></select>
          <select class="confirm-select" id="confirm-continent-select">
            <option value="asia">ğŸŒ äºæ´²</option>
            <option value="europe">ğŸ° æ­æ´²</option>
            <option value="africa">ğŸŒ éæ´²</option>
            <option value="americas">ğŸŒ ç¾æ´²</option>
            <option value="oceania">ğŸï¸ å¤§æ´‹æ´²</option>
          </select>
          <input type="number" class="confirm-select" id="confirm-score" placeholder="åˆ†æ•¸" min="0" max="800" style="width:80px;">
          <button class="confirm-btn" onclick="manualConfirm()">âœ… ç¢ºèªéé—œ</button>
        </div>
      </div>
    </div>
    <div class="sidebar">
      <div class="sidebar-title">ğŸ† å³æ™‚æˆ°æ³æ’è¡Œæ¦œ</div>
      <div id="leaderboard"></div>
    </div>
  </div>
</div>

<!-- ========== SCREEN: STUDENT MAP ========== -->
<div id="student-map" class="screen">
  <div class="student-header">
    <button class="btn-secondary" onclick="showScreen('home')" style="margin:0;padding:6px 12px;font-size:0.85rem;">ğŸ  é¦–é </button>
    <div class="student-team-badge" id="student-team-badge"></div>
    <div id="student-score-display" style="font-family:'Bangers',cursive;font-size:1.2rem;color:var(--gold);"></div>
  </div>
  <h2 style="font-family:'Bangers',cursive;font-size:1.8rem;color:var(--gold);text-align:center;margin:12px 0;">é¸æ“‡è¦é—–é—œçš„å¤§æ´²</h2>
  <div class="student-map-grid" id="student-map-grid"></div>
</div>

<!-- ========== SCREEN: QUIZ ========== -->
<div id="quiz-screen" class="screen">
  <div class="quiz-header">
    <div class="quiz-continent-badge" id="quiz-badge"></div>
    <div id="quiz-q-counter" style="font-size:0.9rem;color:var(--text-muted);"></div>
    <div class="quiz-timer" id="quiz-timer">30</div>
  </div>
  <div class="quiz-progress"><div class="quiz-progress-fill" id="quiz-progress-fill"></div></div>
  <div class="quiz-body" id="quiz-body">
    <div id="quiz-question-area">
      <div class="quiz-question-num" id="quiz-question-num"></div>
      <div class="quiz-question-text" id="quiz-question-text"></div>
      <div class="quiz-options" id="quiz-options"></div>
    </div>
    <div class="quiz-feedback" id="quiz-feedback">
      <div class="feedback-icon" id="feedback-icon"></div>
      <div class="feedback-text" id="feedback-text"></div>
      <div class="feedback-fact" id="feedback-fact"></div>
      <button class="feedback-btn" id="feedback-btn" onclick="nextQuestion()">ä¸‹ä¸€é¡Œ â†’</button>
    </div>
  </div>
</div>

<!-- ========== SCREEN: CONTINENT COMPLETE ========== -->
<div id="continent-complete" class="screen">
  <div class="complete-icon" id="complete-icon">ğŸ‰</div>
  <div class="complete-title" id="complete-title">äºæ´²é—–é—œæˆåŠŸï¼</div>
  <div class="complete-score" id="complete-score"></div>
  <div class="complete-code" id="complete-code"></div>
  <div class="complete-hint">è«‹èˆ‰æ‰‹è®“è€å¸«ç¢ºèªéé—œï¼</div>
  <button class="btn-primary" style="max-width:300px;" onclick="backToStudentMap()">ğŸ—ºï¸ å›åˆ°åœ°åœ–ç¹¼çºŒé—–é—œ</button>
</div>

<!-- ========== SCREEN: VICTORY ========== -->
<div id="victory-screen" class="screen">
  <div class="victory-crown">ğŸ‘‘</div>
  <div class="victory-title">ğŸŠ å† è»èª•ç”Ÿï¼ğŸŠ</div>
  <div class="victory-team" id="victory-team"></div>
  <div class="final-standings" id="final-standings"></div>
</div>

<!-- ========== QR MODAL ========== -->
<div class="modal-overlay" id="qr-modal">
  <div class="modal-card">
    <button class="modal-close" onclick="closeQRModal()">âœ•</button>
    <h2 style="font-family:'Bangers',cursive;font-size:1.8rem;color:var(--gold);text-align:center;">ğŸ“± é—–é—œ QR ç¢¼</h2>
    <p style="text-align:center;color:var(--text-muted);margin:8px 0 4px;">å­¸ç”Ÿæƒæ QR ç¢¼é€²å…¥å°æ‡‰å¤§æ´²çš„é—œå¡</p>
    <p style="text-align:center;color:var(--text-muted);font-size:0.85rem;margin-bottom:16px;">åˆ—å°æç¤ºï¼šæŒ‰ Ctrl+P åˆ—å°æ­¤é </p>
    <div class="qr-grid" id="qr-grid"></div>
    <div style="text-align:center;margin-top:16px;">
      <button class="btn-primary" style="max-width:200px;" onclick="printQRCodes()">ğŸ–¨ï¸ åˆ—å° QR ç¢¼</button>
    </div>
  </div>
</div>

<!-- ========== COUNTDOWN OVERLAY ========== -->
<div id="countdown-overlay" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.9);z-index:2000;align-items:center;justify-content:center;flex-direction:column;">
  <div id="countdown-num" style="font-family:'Bangers',cursive;font-size:8rem;color:var(--gold);"></div>
  <div id="countdown-text" style="font-size:1.3rem;color:var(--text-muted);margin-top:12px;"></div>
</div>

<script>
// =============================================
// GAME CONFIGURATION & STATE
// =============================================
const TEAMS = [
  { id:'A', name:'Açµ„ æ¢éšªå®¶', emoji:'ğŸ¦', color:'#e74c3c' },
  { id:'B', name:'Bçµ„ å†’éšªç‹', emoji:'ğŸ‰', color:'#3498db' },
  { id:'C', name:'Cçµ„ æ—…è¡Œè€…', emoji:'ğŸ¦…', color:'#2ecc71' },
  { id:'D', name:'Dçµ„ ç™¼ç¾å®¶', emoji:'ğŸ¬', color:'#e67e22' },
  { id:'E', name:'Eçµ„ æ¢ç´¢å®¶', emoji:'ğŸ¦‹', color:'#9b59b6' },
  { id:'F', name:'Fçµ„ é–‹æ‹“è€…', emoji:'ğŸ¢', color:'#1abc9c' }
];

const CONTINENTS = [
  { id:'asia', name:'äºæ´²', emoji:'ğŸŒ', countries:'æ—¥æœ¬ ğŸ‡¯ğŸ‡µ Â· æ³°åœ‹ ğŸ‡¹ğŸ‡­', color:'var(--asia)' },
  { id:'europe', name:'æ­æ´²', emoji:'ğŸ°', countries:'æ³•åœ‹ ğŸ‡«ğŸ‡· Â· ç¾©å¤§åˆ© ğŸ‡®ğŸ‡¹', color:'var(--europe)' },
  { id:'africa', name:'éæ´²', emoji:'ğŸŒ', countries:'æ‘©æ´›å“¥ ğŸ‡²ğŸ‡¦ Â· åŸƒåŠ ğŸ‡ªğŸ‡¬', color:'var(--africa)' },
  { id:'americas', name:'ç¾æ´²', emoji:'ğŸŒ', countries:'å¢¨è¥¿å“¥ ğŸ‡²ğŸ‡½ Â· ç¾åœ‹ ğŸ‡ºğŸ‡¸', color:'var(--americas)' },
  { id:'oceania', name:'å¤§æ´‹æ´²', emoji:'ğŸï¸', countries:'æ¾³æ´² ğŸ‡¦ğŸ‡º Â· ç´è¥¿è˜­ ğŸ‡³ğŸ‡¿', color:'var(--oceania)' }
];

const TIME_PER_QUESTION = 30; // seconds
const POINTS_CORRECT = 100;
const POINTS_SPEED_BONUS = 50; // max bonus for fast answer
const TOTAL_CONTINENTS = 5;

// =============================================
// QUIZ QUESTIONS DATABASE (40+ questions)
// =============================================
const QUESTIONS = {
  asia: [
    { q:'é‡‘å¹³ç³–ï¼ˆKonpeitÅï¼‰æœ€æ—©æ˜¯å¾å“ªå€‹åœ‹å®¶å‚³åˆ°æ—¥æœ¬çš„ï¼Ÿ', opts:['è‘¡è„ç‰™','è¥¿ç­ç‰™','è·è˜­','è‹±åœ‹'], ans:0, fact:'1569å¹´è‘¡è„ç‰™å‚³æ•™å£«æŠŠé‡‘å¹³ç³–é€çµ¦äº†æˆ°åœ‹æ­¦å°‡ç¹”ç”°ä¿¡é•·ç•¶ç¦®ç‰©ï¼é‚£æ™‚å€™ç³–éå¸¸çè²´ï¼Œåªæœ‰è²´æ—æ‰åƒå¾—åˆ°ã€‚' },
    { q:'æ—¥æœ¬é§„è“å­å±‹çš„è²¨æ¶ç‚ºä»€éº¼è¨­è¨ˆå¾—ç‰¹åˆ¥çŸ®ï¼Ÿ', opts:['ç¯€çœææ–™','æ–¹ä¾¿å°å­©è‡ªå·±æ‹¿å–','åœ°éœ‡å®‰å…¨','çœ‹èµ·ä¾†æ¯”è¼ƒå¯æ„›'], ans:1, fact:'é§„è“å­å±‹æ˜¯å°ˆé–€çµ¦å°æœ‹å‹çš„é›¶é£Ÿåº—ï¼Œæ¶å­çŸ®çŸ®çš„è®“å°å­©å¯ä»¥è‡ªå·±æŒ‘é¸ã€å­¸ç¿’ç®—éŒ¢è²·æ±è¥¿ï¼Œé€™æ˜¯è¨±å¤šæ—¥æœ¬äººçš„ç«¥å¹´å›æ†¶ï¼' },
    { q:'åšä¸€æ‰¹é‡‘å¹³ç³–éœ€è¦å¤šé•·æ™‚é–“ï¼Ÿ', opts:['1å°æ™‚','1å¤©','7åˆ°13å¤©','1å€‹æœˆ'], ans:2, fact:'å¸«å‚…åœ¨æ—‹è½‰å¤§é‹è£¡ä¸€å±¤ä¸€å±¤æ…¢æ…¢æ·‹ä¸Šç³–æ¼¿ï¼Œæ¯é¡†é‡‘å¹³ç³–æœ€çµ‚æœƒé•·å‡ºå¤§ç´„27å€‹å°çªèµ·ï¼Œæ•´å€‹éç¨‹éœ€è¦7åˆ°13å¤©ï¼' },
    { q:'æ³°åœ‹æ°´ä¸Šå¸‚å ´çš„ã€Œèˆ¹éºµã€ç¢—ç‚ºä»€éº¼ç‰¹åˆ¥å°ï¼Ÿ', opts:['ç¯€çœé£Ÿæ','å°ç¢—æ¯”è¼ƒä¾¿å®œ','é¿å…åœ¨èˆ¹ä¸Šæ™ƒå‹•ç‘å‡ºä¾†','æ³°åœ‹äººé£Ÿé‡å°'], ans:2, fact:'è€é—†è¦åœ¨å°èˆ¹ä¸ŠåŒæ™‚åˆ’èˆ¹ã€ç…®éºµã€èª¿å‘³ã€ç«¯ç¢—ã€æ”¶éŒ¢ï¼ç¢—å¤§äº†æ¹¯æœƒç‘å‡ºä¾†ï¼Œæ‰€ä»¥å®¢äººé€šå¸¸ä¸€æ¬¡åƒ5åˆ°10ç¢—ï¼ŒæŠŠç©ºç¢—ç–Šæˆå°å¡”ï¼' },
    { q:'ä¸¹å«©èæœµæ°´ä¸Šå¸‚å ´çš„é‹æ²³å¤§ç´„æœ‰å¤šé•·ï¼Ÿ', opts:['5å…¬é‡Œ','15å…¬é‡Œ','32å…¬é‡Œ','50å…¬é‡Œ'], ans:2, fact:'æ‹‰ç‘ªå››ä¸–åœ‹ç‹åœ¨1866-1868å¹´ä¸‹ä»¤æŒ–äº†é€™æ¢32å…¬é‡Œé•·çš„é‹æ²³ï¼Œæ¯”åŠå€‹å°åŒ—å¸‚é‚„é•·ï¼æ³°åœ‹å¤æ™‚å€™æ‰€æœ‰äº¤é€šéƒ½é æ°´è·¯ã€‚' },
    { q:'å®‰å¸•ç“¦æ°´ä¸Šå¸‚å ´æ™šä¸Šæœ€å¸å¼•äººçš„è‡ªç„¶å¥‡è§€æ˜¯ä»€éº¼ï¼Ÿ', opts:['è¢ç«èŸ²åŒæ­¥é–ƒçˆ','æµ·è±šè·³æ°´','æ»¿å¤©æ˜Ÿæ–—','å½©è‰²æœˆäº®'], ans:0, fact:'æˆåƒä¸Šè¬éš»è¢ç«èŸ²åœ¨ç´…æ¨¹æ—ä¸ŠåŒæ­¥é–ƒçˆï¼Œæ•´æ£µæ¨¹çœ‹èµ·ä¾†åƒè–èª•æ¨¹ä¸€æ¨£ç™¼å…‰ï¼å®‰å¸•ç“¦ç¤¾å€å› æ­¤ç²å¾—äº†2008å¹´UNESCOéºç”¢ä¿è­·çã€‚' },
    { q:'ä»¥ä¸‹å“ªå€‹ã€Œä¸æ˜¯ã€æ—¥æœ¬é§„è“å­å±‹å¸¸è¦‹çš„é›¶é£Ÿï¼Ÿ', opts:['é‡‘å¹³ç³–','ç¬›ç³–','ä»™è²','å·§å…‹åŠ›è›‹ç³•'], ans:3, fact:'é§„è“å­å±‹çš„é›¶é£Ÿéƒ½éå¸¸ä¾¿å®œï¼ˆ10-100æ—¥åœ“ï¼‰ï¼Œåƒé‡‘å¹³ç³–ã€ç¬›ç³–ã€ä»™è²ã€ä¸¸å­ä¸²éƒ½æ˜¯ç¶“å…¸å“é …ã€‚å·§å…‹åŠ›è›‹ç³•å¤ªè²´å•¦ï¼' },
    { q:'æ—¥æœ¬ç¬›ç³–ï¼ˆFue Ramuneï¼‰æœ‰ä»€éº¼ç‰¹åˆ¥çš„åœ°æ–¹ï¼Ÿ', opts:['æœƒè®Šè‰²','å¯ä»¥å¹å‡ºå“¨è²','æœ‰é­”è¡“æ•ˆæœ','æœƒåœ¨æ°´è£¡æº¶åŒ–è®Šæ±½æ°´'], ans:1, fact:'ã€Œç¬›ã€åœ¨æ—¥æ–‡å°±æ˜¯ã€Œç¬›å­ã€çš„æ„æ€ï¼ç¬›ç³–ä¸­é–“æœ‰å€‹å°æ´ï¼Œæ”¾åœ¨å˜´å”‡ä¸Šå¹å°±èƒ½ç™¼å‡ºçœŸæ­£çš„å“¨è²ï¼Œå˜—èµ·ä¾†åƒæ±½æ°´å‘³ï¼' }
  ],
  europe: [
    { q:'æ³•åœ‹æ³•å¾‹è¦å®šå‚³çµ±æ³•æ£ï¼ˆbaguetteï¼‰åªèƒ½ç”¨å¹¾ç¨®ææ–™è£½ä½œï¼Ÿ', opts:['2ç¨®','4ç¨®','6ç¨®','ä¸é™'], ans:1, fact:'1993å¹´ã€ŒLe DÃ©cret Painã€æ³•ä»¤è¦å®šæ³•æ£åªèƒ½ç”¨éºµç²‰ã€æ°´ã€é¹½ã€é…µæ¯4ç¨®ææ–™ï¼Œä¸”å¿…é ˆåœ¨åº—è£¡ç¾å ´æ‰è£½çƒ˜çƒ¤ï¼' },
    { q:'æ³•åœ‹äººæ¯å¤©å¤§ç´„åƒæ‰å¤šå°‘æ¢æ³•æ£ï¼Ÿ', opts:['100è¬æ¢','800è¬æ¢','1,600è¬æ¢','5,000è¬æ¢'], ans:2, fact:'æ³•åœ‹æ¯å¤©åƒæ‰ç´„1,600è¬æ¢æ³•æ£ï¼Œä¸€å¹´è¿‘60å„„æ¢ï¼ç­‰æ–¼æ¯ç§’åƒæ‰320æ¢ï¼è€Œä¸”æ³•æ£å·²è¢«UNESCOåˆ—ç‚ºäººé¡éç‰©è³ªæ–‡åŒ–éºç”¢ã€‚' },
    { q:'å¯é Œï¼ˆcroissantï¼‰æœ€åˆæ˜¯å“ªå€‹åœ‹å®¶ç™¼æ˜çš„ï¼Ÿ', opts:['æ³•åœ‹','å¥§åœ°åˆ©','ç¾©å¤§åˆ©','ç‘å£«'], ans:1, fact:'å¯é Œçš„å‰èº«æ˜¯å¥§åœ°åˆ©çš„ã€Œkipferlã€æœˆç‰™éºµåŒ…ï¼Œ1838å¹´ç”±å¥§åœ°åˆ©äººAugust Zangå¸¶åˆ°å·´é»ã€‚æ³•æ–‡çš„ã€Œviennoiserieã€æ„æ€å°±æ˜¯ã€Œä¾†è‡ªç¶­ä¹Ÿç´çš„æ±è¥¿ã€ï¼' },
    { q:'å·´é»æœ€ä½³æ³•æ£å¤§è³½çš„å† è»æœƒå¾—åˆ°ä»€éº¼ç‰¹åˆ¥çå‹µï¼Ÿ', opts:['å…è²»å»åº¦å‡','æ•´å¹´é€æ³•æ£çµ¦ç¸½çµ±ç•¶æ—©é¤','æˆç‚ºå·´é»å¸‚é•·','ä¸Šé›»è¦–ä¸€æ•´å¤©'], ans:1, fact:'å† è»é™¤äº†ç²å¾—4,000æ­å…ƒçé‡‘ï¼Œé‚„èƒ½æ•´æ•´ä¸€å¹´æ¯å¤©æ—©ä¸Š6:30é€30æ¢æ–°é®®æ³•æ£åˆ°æ„›éº—èˆå®®çµ¦æ³•åœ‹ç¸½çµ±ç•¶æ—©é¤ï¼' },
    { q:'Gelato å’Œä¸€èˆ¬å†°æ·‡æ·‹æœ€å¤§çš„å·®åˆ¥æ˜¯ä»€éº¼ï¼Ÿ', opts:['é¡è‰²ä¸åŒ','å«ç©ºæ°£é‡è¼ƒå°‘æ›´æ¿ƒå¯†','åªæœ‰å·§å…‹åŠ›å£å‘³','ç”¨å¡‘è† ç¢—è£'], ans:1, fact:'å†°æ·‡æ·‹å«50-70%ç©ºæ°£ï¼Œä½†Gelatoåªæœ‰25-35%ï¼æ‰€ä»¥Gelatoæ›´æ¿ƒå¯†æ»‘é †ï¼Œè„‚è‚ªå«é‡ä¹Ÿæ›´ä½ï¼ŒèˆŒé ­èƒ½å˜—åˆ°æ›´æ¿ƒçƒˆçš„å‘³é“ï¼' },
    { q:'ç™¼æ˜Gelatoçš„Bernardo BuontalentiåŸæœ¬æ˜¯ä»€éº¼è·æ¥­ï¼Ÿ', opts:['å»šå¸«','è¾²å¤«','å»ºç¯‰å¸«å…¼ç•«å®¶','åœ‹ç‹'], ans:2, fact:'Buontalentiæ˜¯ä½›ç¾…å€«æ–¯çš„ç•«å®¶ã€å»ºç¯‰å¸«å’Œå·¥ç¨‹å¸«ï¼ä»–ç‚ºæ¢…è¿ªå¥‡å®¶æ—æ‹›å¾…è¥¿ç­ç‰™åœ‹ç‹æ™‚ç™¼æ˜äº†Gelatoã€‚å¾ˆå¤šä½›ç¾…å€«æ–¯å†°æ·‡æ·‹åº—é‚„æœ‰ä»¥ä»–å‘½åçš„å£å‘³ï¼' },
    { q:'ç¾©å¤§åˆ©æ³¢éš†é‚£æœ‰ä»€éº¼è·Ÿå†°æ·‡æ·‹æœ‰é—œçš„ç‰¹åˆ¥æ©Ÿæ§‹ï¼Ÿ', opts:['å†°æ·‡æ·‹æ³•é™¢','å†°æ·‡æ·‹å¤§å­¸å’Œåšç‰©é¤¨','å†°æ·‡æ·‹éŠ€è¡Œ','å†°æ·‡æ·‹å‹•ç‰©åœ’'], ans:1, fact:'Carpigiani Gelato Museumï¼ˆ2012å¹´é–‹å¹•ï¼‰æ˜¯å…¨ä¸–ç•Œå”¯ä¸€çš„å†°æ·‡æ·‹åšç‰©é¤¨ï¼Œæ”¶è—è¶…éä¸€è¬å¼µç…§ç‰‡ï¼æ—é‚Šé‚„æœ‰ä¸€æ‰€çœŸæ­£çš„å†°æ·‡æ·‹å¤§å­¸ï¼Œåœ¨å…¨çƒæœ‰15å€‹æ ¡å€ï¼' },
    { q:'ä»¥ä¸‹å“ªå€‹ã€Œä¸æ˜¯ã€æ³•åœ‹éºµåŒ…åº—ï¼ˆboulangerieï¼‰çš„å…¸å‹ç‰¹è‰²ï¼Ÿ', opts:['æ¢ç´‹é®é™½æ£š','ç»ç’ƒå±•ç¤ºæ«ƒ','éœ“è™¹æ‹›ç‰Œ','é‡‘è‰²æ‹›ç‰Œå­—'], ans:2, fact:'éœ“è™¹æ‹›ç‰Œæ˜¯ç¾åœ‹1950s Dinerçš„ç‰¹è‰²ï¼æ³•åœ‹éºµåŒ…åº—é€šå¸¸æœ‰å„ªé›…çš„æ¢ç´‹é®é™½æ£šã€é‡‘è‰²è‰æ›¸æ‹›ç‰Œã€é€æ˜ç»ç’ƒå±•ç¤ºæ«ƒè®“ä½ çœ‹åˆ°æ‰€æœ‰ç¾å‘³çš„éºµåŒ…ç³•é»ã€‚' }
  ],
  africa: [
    { q:'æ‘©æ´›å“¥ç¶œåˆé¦™æ–™ã€ŒRas el Hanoutã€çš„é˜¿æ‹‰ä¼¯èªæ„æ€æ˜¯ä»€éº¼ï¼Ÿ', opts:['é­”æ³•ç²‰æœ«','åº—è£¡æœ€å¥½çš„','æ²™æ¼ ä¹‹å¿ƒ','ä¸€ç™¾ç¨®å‘³é“'], ans:1, fact:'æ¯å€‹é¦™æ–™è€é—†éƒ½æœ‰è‡ªå·±çš„ç¨å®¶ç§˜æ–¹ï¼Œæœ‰çš„æ··åˆ12ç¨®é¦™æ–™ï¼Œæœ‰çš„ç”šè‡³æ··åˆè¶…é100ç¨®ï¼å°±åƒæ¯å€‹äººçš„æŒ‡ç´‹ä¸€æ¨£ç¨ä¸€ç„¡äºŒã€‚' },
    { q:'æ‘©æ´›å“¥ Zellige é¦¬è³½å…‹å·¥åŒ éœ€è¦å­¸ç¿’å¤šå°‘å¹´æ‰èƒ½å‡ºå¸«ï¼Ÿ', opts:['1å¹´','5å¹´','è‡³å°‘10å¹´','20å¹´'], ans:2, fact:'Zelligeæœ‰è¶…é1000å¹´æ­·å²ã€‚å› ä¼Šæ–¯è˜­å‚³çµ±ä¸æç¹ªäººå’Œå‹•ç‰©ï¼Œå·¥åŒ ç”¨å¹¾ä½•åœ–æ¡ˆå‰µé€ ç²¾ç¾åœ–æ¡ˆã€‚æ¯ç‰‡å°ç£ç£šéƒ½æ˜¯ç”¨å°éµéšæ‰‹å·¥æ•²ç¢åˆ‡å‰²çš„ï¼' },
    { q:'åœ¨æ‘©æ´›å“¥å¸‚é›†ï¼ˆSoukï¼‰è²·æ±è¥¿ï¼Œæœ€é‡è¦çš„æŠ€å·§æ˜¯ä»€éº¼ï¼Ÿ', opts:['è·‘å¾—å¿«','æ®ºåƒ¹è­°åƒ¹','å¤§è²å–Šå«','ç©¿æ¼‚äº®è¡£æœ'], ans:1, fact:'å¸‚é›†è£¡å•†å“å…¨éƒ¨æ²’æœ‰æ¨™åƒ¹ï¼ä½ è¦å…ˆå‡ºè€é—†é–‹åƒ¹çš„ä¸‰åˆ†ä¹‹ä¸€ï¼Œç„¶å¾Œåƒç©éŠæˆ²ä¸€æ¨£ä¾†å›è­°åƒ¹ã€‚è€é—†é‚„æœƒè«‹ä½ å–è–„è·èŒ¶å‘¢ï¼' },
    { q:'åŸƒåŠå“ˆåˆ©åˆ©å¸‚é›†ï¼ˆKhan el-Khaliliï¼‰å»ºæ–¼å“ªä¸€å¹´ï¼Ÿ', opts:['è¥¿å…ƒ800å¹´','è¥¿å…ƒ1382å¹´','è¥¿å…ƒ1600å¹´','è¥¿å…ƒ1900å¹´'], ans:1, fact:'å·²è¶…é640å¹´æ­·å²ï¼æ›´é©šäººçš„æ˜¯å®ƒè“‹åœ¨ä¸€åº§çš‡å®¶å¢“åœ°ä¸Šé¢â€”â€”é¦¬ç©†é­¯å…‹ç‹æœæ‰“æ•—æ³•è’‚ç‘ªç‹æœå¾Œï¼Œæ‹†æ‰é™µå¢“è“‹äº†é€™å€‹è¶…å¤§å¸‚é›†ã€‚' },
    { q:'è‹±æ–‡çš„ã€Œpaperã€ï¼ˆç´™ï¼‰é€™å€‹å­—ä¾†æºæ–¼ä»€éº¼ï¼Ÿ', opts:['æ‹‰ä¸æ–‡ã€Œå¯«ã€','åŸƒåŠèè‰ç´™ papyrus','å¸Œè‡˜æ–‡ã€Œè–„ã€','ä¸­æ–‡ã€Œå¸›ã€'], ans:1, fact:'å¤åŸƒåŠäººç´„5,000å¹´å‰ç™¼æ˜äº†èè‰ç´™ï¼æŠŠå°¼ç¾…æ²³é‚Šé•·åˆ°4å…¬å°ºé«˜çš„èè‰æ¤ç‰©è–åˆ‡æˆè–„ç‰‡ï¼Œä¸€æ©«ä¸€ç›´äº¤å‰æ’åˆ—ï¼ŒéŒ˜æ‰“å£“å¹³æ›¬ä¹¾ã€‚å¤åŸƒåŠäººé‚„ç”¨èè‰åšé‹å­ã€ç¹©å­ï¼Œç”šè‡³å°èˆ¹ï¼' },
    { q:'å“ˆåˆ©åˆ©å¸‚é›†è£¡çš„è²»æ²™ç¶­å’–å•¡é¤¨æœ‰ä»€éº¼ç‰¹åˆ¥ç´€éŒ„ï¼Ÿ', opts:['å…¨çƒæœ€å¤§çš„å’–å•¡é¤¨','250å¤šå¹´å¾æœªé—œéé–€','åªè³£ä¸€ç¨®å’–å•¡','æœ‰100å±¤æ¨“'], ans:1, fact:'1773å¹´é–‹æ¥­è‡³ä»Šè¶…é250å¹´ï¼Œ24å°æ™‚ç‡Ÿæ¥­ã€365å¤©å…¨å¹´ç„¡ä¼‘ï¼åŒä¸€å€‹å®¶æ—ç¶“ç‡Ÿäº†ä¸ƒä»£ã€‚é€£ç²å¾—è«¾è²çˆ¾æ–‡å­¸ççš„åŸƒåŠå¤§ä½œå®¶é¦¬èµ«ç¦èŒ²éƒ½å¸¸åœ¨è£¡é¢å¯«å°èªªï¼' },
    { q:'å“ˆåˆ©åˆ©å¸‚é›†è£¡å¤§ç´„æœ‰å¤šå°‘é–“åº—èˆ–ï¼Ÿ', opts:['200é–“','1,000é–“','è¶…é4,000é–“','10,000é–“'], ans:2, fact:'è¶…é4,000å®¶åº—èˆ–ï¼æ˜¯ä¸­æ±æœ€å¤§æœ€å¤è€çš„å¸‚é›†ä¹‹ä¸€ã€‚å¸‚é›†è£¡è³£çš„æ±è¥¿å¾éŠ…å™¨ã€ç»ç’ƒç“¶ã€èè‰ç´™ç•«ã€é¦™æ–™åˆ°ç å¯¶æ‡‰æœ‰ç›¡æœ‰ã€‚' },
    { q:'æ‘©æ´›å“¥å¸‚é›†çš„éŠ…ç‡ˆæœ€ç‰¹åˆ¥çš„åœ°æ–¹æ˜¯ä»€éº¼ï¼Ÿ', opts:['å¯ä»¥é˜²èšŠ','æœƒåœ¨ç‰†ä¸ŠæŠ•å°„æ˜Ÿå½¢å…‰å½±','æœƒå”±æ­Œ','æ¯”é»ƒé‡‘é‚„è²´'], ans:1, fact:'æ‰‹å·¥é¤ç©ºçš„éŠ…ç‡ˆé»ä¸Šè Ÿç‡­å¾Œï¼Œå…‰ç·šé€éé¤ç©ºçš„æ˜Ÿå½¢å’Œå¹¾ä½•èŠ±ç´‹ï¼Œæœƒåœ¨å››å‘¨ç‰†å£å’Œå¤©èŠ±æ¿æŠ•å°„å‡ºå¤¢å¹»çš„æ˜Ÿå½¢å…‰å½±ï¼' }
  ],
  americas: [
    { q:'å¤ä»£é˜¿èŒ²ç‰¹å…‹äººåœ¨å¸‚å ´è£¡ç”¨ä»€éº¼ç•¶è²¨å¹£ï¼Ÿ', opts:['è²æ®¼','å¯å¯è±†','çŸ³é ­','ç¾½æ¯›'], ans:1, fact:'å¯å¯è±†å°±æ˜¯åšå·§å…‹åŠ›çš„åŸæ–™ï¼åœ¨å¤ä»£å¢¨è¥¿å“¥å·§å…‹åŠ›å°±æ˜¯éŒ¢ï¼ç‰¹æ‹‰ç‰¹æ´›çˆ¾ç§‘å¸‚å ´æ¯å¤©æœ‰4è¬åˆ°6è¬äººä¾†é€›ã€‚' },
    { q:'å¢¨è¥¿å“¥å‰ªç´™æ——å¹Ÿ Papel Picado åœ¨äº¡éˆç¯€ä»£è¡¨ä»€éº¼å…ƒç´ ï¼Ÿ', opts:['æ°´','ç«','é¢¨','åœŸ'], ans:2, fact:'ç´™æ——éš¨é¢¨é£„å‹•æ™‚ï¼Œå®¶äººç›¸ä¿¡é€™æ˜¯äº¡è€…çš„éˆé­‚å·²ç¶“åˆ°é”çš„ä¿¡è™Ÿï¼è£½ä½œæ™‚æŠŠ40åˆ°50å¼µè–„ç´™ç–Šåœ¨ä¸€èµ·ï¼Œç”¨å°é‘¿å­å’Œéµéšä¸€æ¬¡åˆ‡å‰²ã€‚' },
    { q:'å¢¨è¥¿å“¥å¥‡å¹»å‹•ç‰© Alebrije æ˜¯æ€éº¼è¢«ç™¼æ˜çš„ï¼Ÿ', opts:['ç§‘å­¸å¯¦é©—','è—è¡“å®¶ç™¼é«˜ç‡’åšäº†ä¸€å ´å¤¢','åœ¨æ£®æ—è£¡çœŸçš„çœ‹åˆ°äº†','çœ‹æ¼«ç•«æƒ³åˆ°çš„'], ans:1, fact:'1936å¹´è—è¡“å®¶Pedro Linaresé«˜ç‡’æ˜è¿·ä¸­å¤¢åˆ°é­”æ³•æ£®æ—â€”â€”é•·è´è¶ç¿…è†€çš„é©¢å­ã€é•·ç‰›è§’çš„å…¬é›â€”â€”ç‰ å€‘ä¸åœå–Šè‘—ã€ŒAlebrijeï¼ã€é€£Frida Kahloéƒ½æ¶è‘—æ”¶è—ï¼' },
    { q:'ã€Œå¥¶æ˜”ã€ï¼ˆmilkshakeï¼‰æœ€æ—©å‡ºç¾åœ¨1885å¹´æ™‚ï¼ŒåŸæœ¬æ˜¯ä»€éº¼ï¼Ÿ', opts:['æœæ±','å«å¨å£«å¿Œçš„é…’ç²¾é£²æ–™','ç‰›å¥¶åŠ èœ‚èœœ','å†°æ·‡æ·‹åŠ å¯æ¨‚'], ans:1, fact:'ç›´åˆ°1922å¹´Walgreensè—¥å±€å“¡å·¥éˆæ©Ÿä¸€å‹•å¾€éº¥èŠ½ç‰›å¥¶è£¡åŠ äº†å…©çƒå†°æ·‡æ·‹ï¼Œç¾ä»£å†°æ·‡æ·‹å¥¶æ˜”æ‰æ­£å¼èª•ç”Ÿï¼' },
    { q:'1889å¹´ç¬¬ä¸€å°æŠ•å¹£éŸ³æ¨‚æ©Ÿï¼ˆé»å”±æ©Ÿå‰èº«ï¼‰ï¼Œå®¢äººè¦æ€éº¼è½éŸ³æ¨‚ï¼Ÿ', opts:['æˆ´è€³æ©Ÿ','ç”¨æ©¡è† ç®¡å­æ¹Šè€³æœµè½','ç”¨å–‡å­æ”¾å¤§','çœ‹é»˜åŠ‡è¡¨æ¼”'], ans:1, fact:'å®¢äººè¦å½ä¸‹è…°æŠŠè€³æœµæ¹Šåˆ°å››æ ¹æ©¡è† ç®¡å­ä¸Šè½ï¼ˆåƒè½è¨ºå™¨ï¼ï¼‰ï¼Œè€Œä¸”è¦å…ˆæŠ•ä¸€æšäº”åˆ†é³å¹£ã€‚åˆ°1940-50å¹´ä»£é»å”±æ©Ÿæ‰è®Šæˆé–ƒäº®çš„å½©è‰²éŸ³æ¨‚æ©Ÿï¼' },
    { q:'ç¾åœ‹ç¬¬ä¸€é–“ã€ŒDinerã€é¤å»³æœ€åˆæ˜¯ç”¨ä»€éº¼æ”¹è£çš„ï¼Ÿ', opts:['ç«è»Šè»Šå»‚','é¦¬è»Š','å¸³ç¯·','èˆ¹'], ans:1, fact:'1872å¹´Walter ScottæŠŠä¸€è¼›é¦¬è»Šæ”¹è£æˆæµå‹•å°é¤å»³ï¼Œæ·±å¤œè³£ä¸‰æ˜æ²»å’Œå’–å•¡çµ¦å ±ç¤¾å·¥äººï¼å¾Œä¾†å·¥å» é–‹å§‹å¤§é‡ç”Ÿç”¢é è£½é¤å»³ï¼Œç”¨ç«è»Šé‹åˆ°å„åœ°ã€‚' },
    { q:'å“ªéƒ¨çš®å…‹æ–¯é›»å½±è£¡å‡ºç¾äº†å¢¨è¥¿å“¥å¥‡å¹»å‹•ç‰© Alebrijeï¼Ÿ', opts:['ä¹’ä¹“å¤–å‚³','å¯å¯å¤œç¸½æœƒï¼ˆCocoï¼‰','éˆé­‚æ€¥è½‰å½','è…¦ç­‹æ€¥è½‰å½'], ans:1, fact:'ã€Šå¯å¯å¤œç¸½æœƒã€‹è£¡çš„ç²¾éˆåš®å°Pepitaå°±æ˜¯ä¸€éš»å·¨å¤§çš„å½©è‰²Alebrijeï¼é€™éƒ¨é›»å½±æ·±å…¥å‘ˆç¾äº†å¢¨è¥¿å“¥çš„äº¡éˆç¯€æ–‡åŒ–ã€‚' },
    { q:'ä»¥ä¸‹å“ªå€‹ã€Œä¸æ˜¯ã€1950å¹´ä»£ç¾åœ‹Dinerçš„å…¸å‹ç‰¹è‰²ï¼Ÿ', opts:['éœ“è™¹æ‹›ç‰Œ','é»‘ç™½æ ¼ç´‹åœ°æ¿','ç«¹å­å±é¢¨','ç´…è‰²çš®æ²™ç™¼å¡åº§'], ans:2, fact:'ç«¹å­å±é¢¨æ˜¯äºæ´²é¢¨æ ¼çš„è£é£¾ï¼ç¶“å…¸Dinerçš„æ¨™é…æ˜¯éœ“è™¹æ‹›ç‰Œã€éé‰»å¤–ç‰†ã€ç´…è‰²çš®æ²™ç™¼ã€é»‘ç™½æ ¼åœ°æ¿å’Œæ’­æ”¾æ–æ»¾æ¨‚çš„é»å”±æ©Ÿã€‚' }
  ],
  oceania: [
    { q:'æ¾³æ´²åŸä½æ°‘ã€Œé»ç•«ã€é¢¨æ ¼æœ€åˆæ˜¯ç‚ºäº†ä»€éº¼ç›®çš„ï¼Ÿ', opts:['è®“ç•«æ›´æ¼‚äº®','ä¿è­·ç¥è–æ•…äº‹çš„ç§˜å¯†','ç·´ç¿’æ•¸å­¸','è£é£¾è¡£æœ'], ans:1, fact:'1971å¹´å¸•æ™®å°¼äºçš„è—è¡“å®¶æ“”å¿ƒå¤–äººçœ‹æ‡‚ç¥è–ç¬¦è™Ÿï¼Œæ‰€ä»¥ç”¨ä¸€å±¤å±¤åœ“é»è“‹ä½ç§˜å¯†â€”â€”åªæœ‰çŸ¥é“å¯†ç¢¼çš„æ—äººæ‰èƒ½è®€æ‡‚åº•ä¸‹çš„æ•…äº‹ï¼' },
    { q:'ä»¥ä¸‹é—œæ–¼è¿´åŠ›é¢çš„èªªæ³•ï¼Œå“ªå€‹æ˜¯æ­£ç¢ºçš„ï¼Ÿ', opts:['å…¨éƒ¨éƒ½æœƒé£›å›ä¾†','åªæœ‰æ¾³æ´²æœ‰è¿´åŠ›é¢','å¤§å¤šæ•¸æ˜¯è¨­è¨ˆæˆç›´é£›ä¸å›é ­çš„','åªèƒ½ç”¨æœ¨é ­åš'], ans:2, fact:'æœƒé£›å›ä¾†çš„è¿´åŠ›é¢æ˜¯ç‰¹æ®Šé¡å‹ï¼å¤§å¤šæ•¸çµç”¨è¿´åŠ›é¢æ˜¯ç›´é£›ä¸å›é ­çš„ã€‚æ¾³æ´²æœ€å¤è€çš„è¿´åŠ›é¢æœ‰10,000å¹´æ­·å²ï¼Œé€£å¤åŸƒåŠåœ–å¦å¡é–€æ³•è€å¢“è£¡ä¹Ÿæ‰¾åˆ°äº†è¿´åŠ›é¢ï¼' },
    { q:'åŸä½æ°‘ä½¿ç”¨å¤©ç„¶èµ­çŸ³é¡æ–™ä½œç•«çš„æ­·å²æœ‰å¤šé•·ï¼Ÿ', opts:['1,000å¹´','10,000å¹´','è‡³å°‘65,000å¹´','100è¬å¹´'], ans:2, fact:'é€™æ˜¯åœ°çƒä¸Šæœ€å¤è€çš„æŒçºŒè—è¡“å‚³çµ±ï¼ç´…è‰²ä¾†è‡ªå«éµæ³¥åœŸã€é»ƒè‰²ä¾†è‡ªé»åœŸã€ç™½è‰²ä¾†è‡ªç®¡ç‹€é»åœŸã€é»‘è‰²ä¾†è‡ªæœ¨ç‚­ã€‚åŒ—é ˜åœ°é‚„ç™¼ç¾äº†65,000å¹´å‰çš„èµ­çŸ³ã€Œè Ÿç­†ã€ï¼' },
    { q:'æ¯›åˆ©å‚³èªªä¸­ï¼Œè‹±é›„æ¯›ä¼Šç”¨ä»€éº¼ã€Œé‡£èµ·ã€äº†ç´è¥¿è˜­åŒ—å³¶ï¼Ÿ', opts:['ä¸€æ ¹è¶…é•·é‡£ç«¿','å¤–å©†çš„ä¸‹é¡éª¨åšçš„é­šé‰¤','ä¸€å¼µå¤§ç¶²','ä¸€é¦–æ­Œ'], ans:1, fact:'åŒ—å³¶è‡³ä»Šä»å«ã€ŒTe Ika-a-MÄuiã€ï¼ˆæ¯›ä¼Šä¹‹é­šï¼‰ï¼å¾åœ°åœ–ä¸ŠçœŸçš„å¯ä»¥çœ‹åˆ°éœå…‹ç£åƒé­šé‰¤çš„å½¢ç‹€ã€‚å—å³¶å‰‡è¢«èªªæˆæ˜¯æ¯›ä¼Šçš„ç¨æœ¨èˆŸã€‚' },
    { q:'ç´è¥¿è˜­å—å³¶çš„æ¯›åˆ©èªåç¨±ã€ŒTe Wai Pounamuã€æ˜¯ä»€éº¼æ„æ€ï¼Ÿ', opts:['å±±çš„åœ‹åº¦','é­šçš„æ•…é„‰','ç¶ çŸ³ä¹‹æ°´','é¢¨çš„ç›¡é ­'], ans:2, fact:'Pounamuï¼ˆç¶ ç‰/ç¢§ç‰ï¼‰å…¨ä¸–ç•Œåªæœ‰ç´è¥¿è˜­å—å³¶æ‰æœ‰ï¼é€™ç¨®å¯¶çŸ³å¤ªçè²´äº†ï¼Œæ‰€ä»¥æ•´å€‹å—å³¶éƒ½ç”¨å®ƒä¾†å‘½åã€‚' },
    { q:'æŒ‰ç…§æ¯›åˆ©å‚³çµ±ï¼Œpounamu ç¶ ç‰æœ‰ä»€éº¼ç‰¹åˆ¥è¦çŸ©ï¼Ÿ', opts:['åªæœ‰åœ‹ç‹èƒ½æˆ´','ä¸èƒ½å¸¶å‡ºåœ‹','ä¸èƒ½è²·çµ¦è‡ªå·±ï¼Œå¿…é ˆæ˜¯åˆ¥äººé€çš„ç¦®ç‰©','åªèƒ½åœ¨å†¬å¤©ä½©æˆ´'], ans:2, fact:'æ¯ä¸€å¡Špounamuéš¨è‘—ä¸€ä»£ä¸€ä»£å‚³ä¸‹å»ï¼Œå®ƒçš„éˆæ€§åŠ›é‡ï¼ˆmanaï¼‰æœƒè¶Šä¾†è¶Šå¼·ã€‚æ‰€ä»¥å®ƒå¿…é ˆæ˜¯åˆ¥äººé€ä½ çš„ç¦®ç‰©ï¼Œä¸èƒ½è‡ªå·±è²·ï¼' },
    { q:'ä»¥ä¸‹å“ªå€‹ã€Œä¸æ˜¯ã€ç´è¥¿è˜­çš„ä»£è¡¨æ€§ç‰¹è‰²ï¼Ÿ', opts:['ç¶¿ç¾Š','ç¶ ç‰','è¥¿ç“œ','å¥‡ç•°æœ'], ans:2, fact:'ç´è¥¿è˜­ä»¥ç¶¿ç¾Šï¼ˆæ•¸é‡æ¯”äººå¤šï¼ï¼‰ã€ç¶ ç‰ï¼ˆpounamuï¼‰ã€å¥‡ç•°æœå’ŒéŠ€è•¨èåã€‚è¥¿ç“œä¸æ˜¯ç´è¥¿è˜­çš„ä»£è¡¨æ€§ç‰¹ç”¢å”·ï¼' },
    { q:'Koru èºæ—‹åœ–é¨°ä¾†è‡ªä»€éº¼æ¤ç‰©çš„å½¢ç‹€ï¼Ÿ', opts:['éŠ€è•¨å«©è‘‰','ç«ç‘°èŠ±è‹','ç«¹ç­','ä»™äººæŒ'], ans:0, fact:'Koruä¾†è‡ªéŠ€è•¨å«©è‘‰å±•é–‹æ™‚çš„æ²æ›²å½¢ç‹€ï¼Œæ¯›åˆ©èªæ„æ€æ˜¯ã€Œè¿´åœˆã€ï¼Œè±¡å¾µæ–°ç”Ÿå‘½ã€‚ç´è¥¿è˜­èˆªç©ºç›´æ¥ç”¨Koruç•¶Logoï¼Œå…¨é»‘éšŠä¹Ÿç”¨éŠ€è•¨ä½œéšŠå¾½ï¼' }
  ]
};

// =============================================
// GAME STATE
// =============================================
let gameState = {
  roomCode: '',
  teams: {},
  currentTeam: null,
  currentContinent: null,
  currentQuestionIndex: 0,
  currentScore: 0,
  timerInterval: null,
  timeLeft: 0,
  quizQuestions: [],
  answered: false
};

// Initialize teams
function initTeams() {
  gameState.teams = {};
  TEAMS.forEach(t => {
    gameState.teams[t.id] = {
      ...t,
      totalScore: 0,
      completedContinents: {},
      progress: 0
    };
  });
}
initTeams();

// =============================================
// SCREEN MANAGEMENT
// =============================================
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

// =============================================
// HOME & SETUP
// =============================================
function goToSetup(role) {
  if (role === 'teacher') {
    showScreen('room-setup');
  } else {
    // Check URL params first
    const params = new URLSearchParams(window.location.search);
    const continent = params.get('c');
    if (continent && QUESTIONS[continent]) {
      showScreen('team-select');
      gameState.currentContinent = continent;
    } else {
      showScreen('team-select');
    }
    buildTeamGrid();
  }
}

function createRoom() {
  const code = Math.random().toString(36).substring(2,6).toUpperCase();
  gameState.roomCode = code;
  document.getElementById('generated-code').textContent = code;
  document.getElementById('generated-code').style.display = 'block';
  document.getElementById('create-room-btn').style.display = 'none';
  document.getElementById('enter-room-btn').style.display = 'block';
  saveState();
}

function enterDashboard() {
  document.getElementById('dash-room-code').textContent = 'æˆ¿é–“ ' + gameState.roomCode;
  buildDashboard();
  showScreen('teacher-dashboard');
}

// =============================================
// TEAM SELECTION
// =============================================
function buildTeamGrid() {
  const grid = document.getElementById('team-grid');
  grid.innerHTML = TEAMS.map(t => `
    <div class="team-card" data-team="${t.id}" onclick="selectTeam('${t.id}')" style="--tc:${t.color}">
      <span class="team-emoji">${t.emoji}</span>
      <span class="team-name" style="color:${t.color}">${t.name}</span>
    </div>
  `).join('');
}

function selectTeam(id) {
  document.querySelectorAll('.team-card').forEach(c => c.classList.remove('selected'));
  document.querySelector(`.team-card[data-team="${id}"]`).classList.add('selected');
  gameState.currentTeam = id;
  document.getElementById('confirm-team-btn').disabled = false;
}

function confirmTeam() {
  if (!gameState.currentTeam) return;
  const team = TEAMS.find(t => t.id === gameState.currentTeam);
  const badge = document.getElementById('student-team-badge');
  badge.textContent = team.emoji + ' ' + team.name;
  badge.style.background = team.color + '33';
  badge.style.color = team.color;
  badge.style.border = '2px solid ' + team.color;

  // If we came from a QR code with a specific continent, go straight to quiz
  if (gameState.currentContinent && QUESTIONS[gameState.currentContinent]) {
    startCountdown(gameState.currentContinent);
  } else {
    buildStudentMap();
    showScreen('student-map');
  }
}

// =============================================
// STUDENT MAP
// =============================================
function buildStudentMap() {
  const grid = document.getElementById('student-map-grid');
  const teamData = gameState.teams[gameState.currentTeam];
  const scoreEl = document.getElementById('student-score-display');
  scoreEl.textContent = 'â­ ' + (teamData ? teamData.totalScore : 0) + ' åˆ†';

  grid.innerHTML = CONTINENTS.map(c => {
    const done = teamData && teamData.completedContinents[c.id];
    return `
      <div class="student-continent-btn ${done ? 'done' : ''}" 
           style="border-color:${done ? 'rgba(255,255,255,0.1)' : c.color}" 
           onclick="${done ? '' : `startCountdown('${c.id}')`}">
        <div class="smap-emoji">${c.emoji}</div>
        <div class="smap-name">${c.name}</div>
        <div class="smap-status">${done ? 'âœ… å·²å®Œæˆ' : c.countries}</div>
      </div>
    `;
  }).join('');
}

// =============================================
// COUNTDOWN & QUIZ START
// =============================================
function startCountdown(continentId) {
  gameState.currentContinent = continentId;
  gameState.currentQuestionIndex = 0;
  gameState.currentScore = 0;

  // Shuffle questions for this continent
  gameState.quizQuestions = [...QUESTIONS[continentId]].sort(() => Math.random() - 0.5);

  const overlay = document.getElementById('countdown-overlay');
  const numEl = document.getElementById('countdown-num');
  const textEl = document.getElementById('countdown-text');
  const continent = CONTINENTS.find(c => c.id === continentId);

  overlay.style.display = 'flex';
  textEl.textContent = continent.emoji + ' ' + continent.name + 'ç«™ â€” æº–å‚™å¥½äº†å—ï¼Ÿ';

  let count = 3;
  numEl.textContent = count;
  numEl.style.animation = 'countDown 0.8s ease';

  const cdInterval = setInterval(() => {
    count--;
    if (count > 0) {
      numEl.textContent = count;
      numEl.style.animation = 'none';
      void numEl.offsetWidth;
      numEl.style.animation = 'countDown 0.8s ease';
    } else {
      clearInterval(cdInterval);
      numEl.textContent = 'GO!';
      numEl.style.color = 'var(--correct)';
      setTimeout(() => {
        overlay.style.display = 'none';
        numEl.style.color = 'var(--gold)';
        startQuiz();
      }, 500);
    }
  }, 800);
}

// =============================================
// QUIZ ENGINE
// =============================================
function startQuiz() {
  showScreen('quiz-screen');
  showQuestion();
}

function showQuestion() {
  const qi = gameState.currentQuestionIndex;
  const questions = gameState.quizQuestions;
  if (qi >= questions.length) {
    finishContinent();
    return;
  }

  const q = questions[qi];
  const continent = CONTINENTS.find(c => c.id === gameState.currentContinent);
  const continentColors = { asia:'var(--asia)', europe:'var(--europe)', africa:'var(--africa)', americas:'var(--americas)', oceania:'var(--oceania)' };

  // Update header
  document.getElementById('quiz-badge').textContent = continent.emoji + ' ' + continent.name;
  document.getElementById('quiz-badge').style.background = continentColors[continent.id].replace('var(--','').replace(')','');
  document.getElementById('quiz-badge').style.background = getComputedStyle(document.documentElement).getPropertyValue('--'+continent.id).trim() + '33';
  document.getElementById('quiz-badge').style.color = getComputedStyle(document.documentElement).getPropertyValue('--'+continent.id).trim();
  document.getElementById('quiz-q-counter').textContent = `ç¬¬ ${qi+1}/${questions.length} é¡Œ`;

  // Progress bar
  document.getElementById('quiz-progress-fill').style.width = ((qi / questions.length) * 100) + '%';

  // Question
  document.getElementById('quiz-question-area').style.display = 'block';
  document.getElementById('quiz-feedback').classList.remove('show');
  document.getElementById('quiz-question-num').textContent = `ç¬¬ ${qi+1} é¡Œï¼Œå…± ${questions.length} é¡Œ`;
  document.getElementById('quiz-question-text').textContent = q.q;

  // Options
  const letters = ['A','B','C','D'];
  const optionsEl = document.getElementById('quiz-options');
  optionsEl.innerHTML = q.opts.map((opt, i) => `
    <div class="quiz-option" data-index="${i}" onclick="answerQuestion(${i})">
      <span class="opt-letter">${letters[i]}</span>
      <span>${opt}</span>
    </div>
  `).join('');

  // Timer
  gameState.timeLeft = TIME_PER_QUESTION;
  gameState.answered = false;
  updateTimerDisplay();
  clearInterval(gameState.timerInterval);
  gameState.timerInterval = setInterval(() => {
    gameState.timeLeft--;
    updateTimerDisplay();
    if (gameState.timeLeft <= 0) {
      clearInterval(gameState.timerInterval);
      if (!gameState.answered) timeUp();
    }
  }, 1000);
}

function updateTimerDisplay() {
  const timerEl = document.getElementById('quiz-timer');
  timerEl.textContent = gameState.timeLeft;
  timerEl.classList.toggle('urgent', gameState.timeLeft <= 5);
}

function answerQuestion(selectedIndex) {
  if (gameState.answered) return;
  gameState.answered = true;
  clearInterval(gameState.timerInterval);

  const q = gameState.quizQuestions[gameState.currentQuestionIndex];
  const isCorrect = selectedIndex === q.ans;

  // Highlight answers
  document.querySelectorAll('.quiz-option').forEach((opt, i) => {
    opt.classList.add('disabled');
    if (i === q.ans) opt.classList.add('correct');
    if (i === selectedIndex && !isCorrect) opt.classList.add('wrong');
  });

  // Calculate score
  let points = 0;
  if (isCorrect) {
    const speedBonus = Math.round((gameState.timeLeft / TIME_PER_QUESTION) * POINTS_SPEED_BONUS);
    points = POINTS_CORRECT + speedBonus;
    gameState.currentScore += points;
  }

  // Play sound effect (using Web Audio API)
  playSound(isCorrect);

  // Show feedback after a brief delay
  setTimeout(() => {
    showFeedback(isCorrect, q, points);
  }, 800);
}

function timeUp() {
  gameState.answered = true;
  const q = gameState.quizQuestions[gameState.currentQuestionIndex];
  document.querySelectorAll('.quiz-option').forEach((opt, i) => {
    opt.classList.add('disabled');
    if (i === q.ans) opt.classList.add('correct');
  });
  setTimeout(() => {
    showFeedback(false, q, 0, true);
  }, 800);
}

function showFeedback(isCorrect, question, points, isTimeout = false) {
  document.getElementById('quiz-question-area').style.display = 'none';
  const fb = document.getElementById('quiz-feedback');
  fb.classList.add('show');

  document.getElementById('feedback-icon').textContent = isTimeout ? 'â°' : (isCorrect ? 'ğŸ‰' : 'ğŸ˜¢');
  document.getElementById('feedback-text').textContent = isTimeout
    ? 'æ™‚é–“åˆ°ï¼'
    : (isCorrect ? `ç­”å°äº†ï¼+${points} åˆ†` : 'ç­”éŒ¯äº†ï½');
  document.getElementById('feedback-text').style.color = isCorrect ? 'var(--correct)' : 'var(--wrong)';
  document.getElementById('feedback-fact').innerHTML = 'ğŸ’¡ <strong>ä½ çŸ¥é“å—ï¼Ÿ</strong><br>' + question.fact;

  const isLast = gameState.currentQuestionIndex >= gameState.quizQuestions.length - 1;
  document.getElementById('feedback-btn').textContent = isLast ? 'ğŸ çœ‹çµæœ' : 'ä¸‹ä¸€é¡Œ â†’';
}

function nextQuestion() {
  gameState.currentQuestionIndex++;
  if (gameState.currentQuestionIndex >= gameState.quizQuestions.length) {
    finishContinent();
  } else {
    showQuestion();
  }
}

// =============================================
// CONTINENT COMPLETE
// =============================================
function finishContinent() {
  clearInterval(gameState.timerInterval);
  const continent = CONTINENTS.find(c => c.id === gameState.currentContinent);
  const team = gameState.teams[gameState.currentTeam];

  // Record completion
  if (team) {
    team.completedContinents[gameState.currentContinent] = {
      score: gameState.currentScore,
      time: new Date().toISOString()
    };
    team.totalScore += gameState.currentScore;
    team.progress = (Object.keys(team.completedContinents).length / TOTAL_CONTINENTS) * 100;
  }

  // Generate completion code
  const code = gameState.currentContinent.substring(0,2).toUpperCase() + '-' + gameState.currentTeam + '-' + gameState.currentScore;

  document.getElementById('complete-icon').textContent = continent.emoji;
  document.getElementById('complete-title').textContent = continent.name + ' é—–é—œæˆåŠŸï¼';
  document.getElementById('complete-score').textContent = 'æœ¬ç«™å¾—åˆ†ï¼š' + gameState.currentScore + ' åˆ† â­';
  document.getElementById('complete-code').textContent = code;

  showScreen('continent-complete');
  launchConfetti();
  saveState();

  // Check if all continents done
  if (team && Object.keys(team.completedContinents).length >= TOTAL_CONTINENTS) {
    setTimeout(() => {
      showVictory();
    }, 3000);
  }
}

function backToStudentMap() {
  buildStudentMap();
  showScreen('student-map');
}

// =============================================
// TEACHER DASHBOARD
// =============================================
function buildDashboard() {
  // Build continent map
  const mapEl = document.getElementById('continent-map-teacher');
  mapEl.innerHTML = CONTINENTS.map(c => `
    <div class="continent-card" data-continent="${c.id}" onclick="showQRForContinent('${c.id}')">
      <div class="continent-emoji">${c.emoji}</div>
      <div class="continent-name">${c.name}</div>
      <div class="continent-countries">${c.countries}</div>
    </div>
  `).join('');

  // Build team select dropdown
  const teamSelect = document.getElementById('confirm-team-select');
  teamSelect.innerHTML = TEAMS.map(t => `<option value="${t.id}">${t.emoji} ${t.name}</option>`).join('');

  updateLeaderboard();
}

function updateLeaderboard() {
  const lb = document.getElementById('leaderboard');
  const sorted = Object.values(gameState.teams).sort((a, b) => b.totalScore - a.totalScore || b.progress - a.progress);

  lb.innerHTML = sorted.map((team, idx) => {
    const barColor = team.color;
    const pct = team.progress;
    const stamps = CONTINENTS.map(c => {
      const done = team.completedContinents[c.id];
      return `<div class="stamp ${done ? 'completed' : ''}" data-c="${c.id}" title="${c.name}">${c.emoji}</div>`;
    }).join('');

    return `
      <div class="team-row" style="border-left:4px solid ${team.color};">
        <div class="team-row-header">
          <span class="team-row-name">${team.emoji} ${team.name}</span>
          <span class="team-row-score">â­ ${team.totalScore}</span>
        </div>
        <div class="hp-bar-bg">
          <div class="hp-bar-text">${Math.round(pct)}%</div>
          <div class="hp-bar-fill" style="width:${pct}%;background:linear-gradient(90deg,${team.color},${team.color}dd);"></div>
        </div>
        <div class="team-stamps">${stamps}</div>
      </div>
    `;
  }).join('');
}

function manualConfirm() {
  const teamId = document.getElementById('confirm-team-select').value;
  const continentId = document.getElementById('confirm-continent-select').value;
  const score = parseInt(document.getElementById('confirm-score').value) || 500;

  const team = gameState.teams[teamId];
  if (!team) return;

  if (!team.completedContinents[continentId]) {
    team.completedContinents[continentId] = { score: score, time: new Date().toISOString() };
    team.totalScore += score;
    team.progress = (Object.keys(team.completedContinents).length / TOTAL_CONTINENTS) * 100;
  }

  updateLeaderboard();
  saveState();
  document.getElementById('confirm-score').value = '';

  // Check for winner
  if (team.progress >= 100) {
    setTimeout(() => {
      showVictory();
    }, 1000);
  }
}

// =============================================
// QR CODE GENERATION
// =============================================
function showQRModal() {
  const modal = document.getElementById('qr-modal');
  modal.classList.add('active');
  generateAllQRCodes();
}

function closeQRModal() {
  document.getElementById('qr-modal').classList.remove('active');
}

function showQRForContinent(id) {
  showQRModal();
}

function generateAllQRCodes() {
  const grid = document.getElementById('qr-grid');
  grid.innerHTML = '';

  const baseUrl = window.location.origin + window.location.pathname;

  CONTINENTS.forEach(c => {
    const item = document.createElement('div');
    item.className = 'qr-item';
    item.innerHTML = `<div id="qr-${c.id}"></div><div class="qr-label" style="color:${c.color}">${c.emoji} ${c.name}</div><div style="font-size:0.75rem;color:var(--text-muted);margin-top:4px;">${c.countries}</div>`;
    grid.appendChild(item);

    const url = baseUrl + '?c=' + c.id;
    setTimeout(() => {
      const qrContainer = document.getElementById('qr-' + c.id);
      qrContainer.innerHTML = '';
      new QRCode(qrContainer, {
        text: url,
        width: 160,
        height: 160,
        colorDark: '#ffffff',
        colorLight: '#1b2838',
        correctLevel: QRCode.CorrectLevel.M
      });
    }, 100);
  });
}

function printQRCodes() {
  window.print();
}

// =============================================
// VICTORY
// =============================================
function showVictory() {
  const sorted = Object.values(gameState.teams).sort((a, b) => b.totalScore - a.totalScore);
  const winner = sorted[0];

  document.getElementById('victory-team').innerHTML = `<span style="color:${winner.color}">${winner.emoji} ${winner.name}</span><br><span style="font-size:1rem;color:var(--gold);">ç¸½åˆ† ${winner.totalScore} åˆ†</span>`;

  const medals = ['ğŸ¥‡','ğŸ¥ˆ','ğŸ¥‰','4ï¸âƒ£','5ï¸âƒ£','6ï¸âƒ£'];
  document.getElementById('final-standings').innerHTML = sorted.map((t, i) => `
    <div class="final-row" style="${i===0?'background:rgba(245,200,66,0.15);border:2px solid var(--gold);':''}">
      <span class="final-rank">${medals[i]}</span>
      <div class="final-info">
        <div class="final-name" style="color:${t.color}">${t.emoji} ${t.name}</div>
        <div class="final-pts">â­ ${t.totalScore} åˆ† Â· ${Object.keys(t.completedContinents).length}/${TOTAL_CONTINENTS} æ´²</div>
      </div>
    </div>
  `).join('');

  showScreen('victory-screen');
  launchConfetti();
}

// =============================================
// EFFECTS
// =============================================
function playSound(isCorrect) {
  try {
    const ctx = new (window.AudioContext || window.webkitAudioContext)();
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();
    osc.connect(gain);
    gain.connect(ctx.destination);
    gain.gain.value = 0.15;
    if (isCorrect) {
      osc.frequency.value = 523;
      osc.start();
      setTimeout(() => { osc.frequency.value = 659; }, 100);
      setTimeout(() => { osc.frequency.value = 784; }, 200);
      setTimeout(() => { osc.stop(); ctx.close(); }, 400);
    } else {
      osc.frequency.value = 200;
      osc.type = 'sawtooth';
      osc.start();
      setTimeout(() => { osc.frequency.value = 150; }, 150);
      setTimeout(() => { osc.stop(); ctx.close(); }, 300);
    }
  } catch(e) {}
}

function launchConfetti() {
  const colors = ['#e74c3c','#3498db','#2ecc71','#f1c40f','#9b59b6','#e67e22','#1abc9c','#ff6b9d'];
  for (let i = 0; i < 60; i++) {
    setTimeout(() => {
      const piece = document.createElement('div');
      piece.className = 'confetti-piece';
      piece.style.left = Math.random() * 100 + 'vw';
      piece.style.background = colors[Math.floor(Math.random() * colors.length)];
      piece.style.width = (Math.random() * 10 + 5) + 'px';
      piece.style.height = (Math.random() * 10 + 5) + 'px';
      piece.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';
      piece.style.animationDuration = (Math.random() * 2 + 2) + 's';
      document.body.appendChild(piece);
      setTimeout(() => piece.remove(), 4000);
    }, i * 30);
  }
}

// =============================================
// STATE PERSISTENCE (localStorage)
// =============================================
function saveState() {
  try {
    localStorage.setItem('kingdomStore', JSON.stringify({
      roomCode: gameState.roomCode,
      teams: gameState.teams
    }));
  } catch(e) {}
}

function loadState() {
  try {
    const saved = localStorage.getItem('kingdomStore');
    if (saved) {
      const data = JSON.parse(saved);
      if (data.teams) {
        Object.keys(data.teams).forEach(id => {
          if (gameState.teams[id]) {
            Object.assign(gameState.teams[id], data.teams[id]);
          }
        });
      }
      if (data.roomCode) gameState.roomCode = data.roomCode;
    }
  } catch(e) {}
}

function resetGame() {
  if (!confirm('ç¢ºå®šè¦é‡ç½®æ‰€æœ‰éšŠä¼çš„åˆ†æ•¸å’Œé€²åº¦å—ï¼Ÿ')) return;
  initTeams();
  saveState();
  updateLeaderboard();
}

// =============================================
// AUTO-REFRESH LEADERBOARD
// =============================================
setInterval(() => {
  if (document.getElementById('teacher-dashboard').classList.contains('active')) {
    loadState();
    updateLeaderboard();
  }
}, 3000);

// =============================================
// INIT
// =============================================
window.addEventListener('DOMContentLoaded', () => {
  loadState();

  // Check URL params
  const params = new URLSearchParams(window.location.search);
  const continent = params.get('c');

  if (continent && QUESTIONS[continent]) {
    // Student scanned QR code for specific continent
    gameState.currentContinent = continent;
    buildTeamGrid();
    showScreen('team-select');
  }
});
</script>
</body>
</html>
